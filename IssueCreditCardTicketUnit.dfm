object frmIssueCreditCardTicket: TfrmIssueCreditCardTicket
  Left = 468
  Top = 279
  Width = 563
  Height = 340
  BiDiMode = bdRightToLeft
  Caption = #1576#1604#1610#1591' '#1575#1593#1578#1576#1575#1585#1610
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -16
  Font.Name = 'Koodak'
  Font.Style = []
  KeyPreview = True
  OldCreateOrder = False
  ParentBiDiMode = False
  Position = poDesktopCenter
  PixelsPerInch = 96
  TextHeight = 28
  object Label2: TLabel
    Left = 466
    Top = 28
    Width = 80
    Height = 29
    Caption = #1588#1605#1575#1585#1607' '#1705#1575#1585#1578':'
    Font.Charset = ARABIC_CHARSET
    Font.Color = clWindowText
    Font.Height = -16
    Font.Name = 'Traffic'
    Font.Style = [fsBold]
    ParentFont = False
  end
  object edtCreditCardID: TEdit
    Left = 336
    Top = 24
    Width = 127
    Height = 37
    Color = clInfoBk
    Font.Charset = ARABIC_CHARSET
    Font.Color = clWindowText
    Font.Height = -17
    Font.Name = 'Koodak'
    Font.Style = [fsBold]
    ParentFont = False
    TabOrder = 0
  end
  object BtnPrint: TBitBtn
    Left = 0
    Top = 64
    Width = 545
    Height = 233
    Caption = #1670#1575#1662'  '
    Font.Charset = DEFAULT_CHARSET
    Font.Color = clWindowText
    Font.Height = -67
    Font.Name = 'Koodak'
    Font.Style = [fsBold]
    ParentFont = False
    TabOrder = 1
    OnClick = BtnPrintClick
    Glyph.Data = {
      060C0000424D060C00000000000036000000280000001C0000001B0000000100
      200000000000D00B0000120B0000120B00000000000000000000D8E9EC00D8E9
      EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9
      EC00D8E9EC00D8E9EC00DAEAEC00DEECEE00DEEBEE00D9E9EC00D8E9EC00D8E9
      EC00D9E9EC00DAEAED00DBEAEC00DBEAED00D8E9EC00D8E9EC00D8E9EC00D8E9
      EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9
      EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00DCEBEE00DFECEE00D1D4D4009F9F
      9F00A2A3A300CED2D300E0EAEC00E0ECEE00D3DBDC00BEC2C300D1D1D100E9EB
      EB00DAE9EC00DEECEF00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9
      EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D9E9EC00E3EF
      F200DDE3E500A2A2A200949494006B6B6B005151510055565600797C7C00938C
      8C0090888800616060005858580087888800C3C5C500E5E9EA00E1EEF000E7F1
      F300DAE9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9
      EC00D8E9EC00D9EAED00E3E9EA00AEAEAE008C8D8D00A8A8A800EBEBEB00C2C2
      C2009E9F9F007B7A7A00705E5E0084676700AC9E9E00B6B5B5009A9A9A006666
      66004B4B4B0072727200AAAAAA00DBDBDB00E7EEEF00D7E8EB00D8E9EC00D8E9
      EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00E8EFF100D1D5D6008D8D8D009F9F
      9F00D9D9D900FDFDFD00F4F4F400B7B7B700BBBCBC00B7B4B400826F6F006F64
      64007676760099999900BABABA00C1C1C100AFAFAF007C7C7C00505050005F5F
      5F0095959500CED7D900D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00EAF1
      F200A2A2A20090909000D5D5D500F6F6F600FBFBFB00EDEDED00E7E7E700B1B1
      B100AFAFAF00ADADAD005C5C5C003F414100585858006A696900808080009E9E
      9E00BDBDBD00CECECE00CACACA009B9B9B0078787800BBBCBC00D8E9EC00D8E9
      EC00D8E9EC00D8E9EC00EEF6F700B9B9B900C8C8C800F3F3F300FCFCFC00F3F3
      F300EDEDED00E9E9E900E3E3E300AEAEAE00A8A8A800AEAEAE00ADADAD009999
      99007F7F7F00717171006F6F6F007E7E7E0093939300ABABAB00BABABA009898
      98009E9E9E00DDEAEC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00ECF2F300C6C6
      C600F5F5F500F8F8F800F3F3F300F0F0F000E7E7E700D4D4D400BBBBBB009393
      930098989800A3A3A300ADADAD00B6B6B600BDBDBD00B4B4B400AAAAAA009B9B
      9B00757575006E6D6D00B6B5B6006F6F6F00BEC4C500D9E9EC00D8E9EC00D8E9
      EC00D8E9EC00D8E9EC00EEF4F500C6C6C600F5F5F500F6F6F600E7E7E700CCCC
      CC00B1B1B100AAAAAA00B9B9B9009595950087878700898989008E8E8E009999
      9900A5A5A500B2B2B200BDBDBD00C4C4C400BCBCBC00ABAAAB00C5C5C5007878
      7800C1C7C800D8E8EB00DAEAED00E9F2F400E8F2F400E6F1F300F6F9FA00C3C3
      C300DCDCDC00C8C8C800B1B1B100B0B0B000C4C4C400D8D8D800DCDCDC00C6C6
      C600B8B8B800A6A6A6009A9A9A008E8E8E008A8A8A00929292009A9A9A00A5A5
      A500BAB6B900B2C3B90090BFA00069736C00C2C7C800D8E8EB00DCEBEE00EBE8
      E700E9E6E500EAE7E600EAE6E600A8A8A800B2B2B200BEBEBE00D0D0D000E3E3
      E300DEDEDE00CFCFCF00DEDEDE00F0F0F000E4E4E400E0E0E000D4D4D400C9C9
      C900BBBBBB00A6A6A6009A9A9A0094949400979496008A988F00739A81006068
      6300C4C9CB00D8E8EB00CDDADF0076828900626F7600647279005E6C71009B9C
      9C00E1DFDE00E6E6E600E3E3E300D8D8D800CECECE00D6D6D600EBEBEB00C9C9
      C900D0D0D000D0D0D000D3D3D300D7D7D700DADADA00E0E0E000D7D7D700C4C4
      C400B4B5B400ACABAC00A5A0A40067676700B9BBBB00D8E8EA003291BA002988
      B400338DBA00318FBC002082B0009EBCCB00EDE9E600DFDEDE00D6D6D600CFCF
      CF00D3D3D300EBEBEB00D0D0D000DADADA00EDEDED00E5E5E500D9D9D900D0D0
      D000CCCCCC00C7C7C700CACACA00D8D8D800DBDBDB00DAD9D900D2D1D1008181
      8200C1C1C100D9E8EB0034A1D00056C0F0006FD6FF006AD2FF0061CFFF0091BE
      D500DED9D600DBD7D600D3D2D100D7D7D700E2E2E200D3D3D300E0E0E000F7F7
      F700F4F4F400F2F2F200F0F0F000EDEDED00E7E7E700E1E1E100D8D8D800C9C9
      C900C3C3C300CCCCCC00C1C1C100A1A1A100E1E1E100DBEAED004BACD4005FBC
      E70079DDFF0070D5FF0071D9FF006FCDF30097C1D100B5C1C600BFC3C600CBCB
      CB00CDCECD00C8C7C800D3D3D300E4E3E300EBEAEA00EEEEEE00F0F0F000EFEF
      EF00EDEDED00ECECEC00ECECEC00EDEDED00E4E4E400BCBCBC009B9B9B00CBCB
      CB00DDEBEE00D8E9EC0053B4D40061B7DE007FE0FF0074DBFF0076DBFF0075DD
      FF006FDCFF006ACDED008BB8C900DFDAD800F2F5F700C2C5C9009CA0A200A9AC
      AD00B5B8B900C7C8C900D6D6D700DFDFDF00E3E2E100EBEBEB00E9E9E900DCDC
      DC00C2C3C300B5B5B500CECFD000DCE9EC00D8E9EC00D8E9EC005BC0DB005FB8
      DE008AE1FD007AE2FF007BE0FF007BE0FF007CE1FF0077E3FD0099D3E600F0E6
      E300FFEDE800E2C5C000CCB9B500C7BDBC00C3BFC000BFBFC000BFC2C500C6CB
      D000DBDFE100C1C1C100B6B6B600CBCDCD00C4C6C600D3DBDD00E0ECEE00D8E9
      EC00D8E9EC00D8E9EC005EC7DF0057B6DD009DE4FA007DE8FF0080E6FF0080E6
      FF0080E6FF007FE6FF007FDBF100B5C4C200FFC9A200FFCFAB00FFD2B200FDCE
      B100F7CEB300F0D1BA00ECD4C000E9D7C600DCD5D0009B9A9C00C6C6C600D8E4
      E700DCE8EA00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC0066CBE4005BBB
      E500A5E4F60084EFFF0086EDFF0087EDFF0087EDFF0086EFFF007EE5F500B7C0
      B900FFD9AC00FFDCB300FFD8B000FFD8AF00FFD9B000FFD9B100FFDAB100FFE2
      B600A68C7E009A999C00F5F7F700D9E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9
      EC00D8E9EC00D8E9EC0071D0E70062C2EF009DDEF30096F7FF0089F2FF008CF2
      FF008CF2FF008AF5FF008CE4ED00D2BFAF00FFE2BE00FFE0BF00FFE0C000FFE0
      C000FFE0BF00FFE0BF00FFE3C100FFDEBC00948076008E8E9000EEF0F000D9E9
      EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC007CD3E90068C9
      FA0095DAF400AAFFFF0089F8FF0090F8FF0090F9FF008CF9FF0098D8DD00EACE
      B900FFE8CC00FFE4CA00FFE4CA00FFE4CA00FFE4CA00FFE4CA00FFEACF00F3D8
      C100B4A8A40087898A00E2E2E200D9E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9
      EC00D8E9EC00D8E9EC0083D5EA006FD2FD008ED6F800BDFFFF009FFFFF00A3FE
      FF00A3FFFF009EFAFB00B0CFCC00FBDCC700FFEFD900FFEAD500FFEAD500FFEA
      D500FFEAD500FFEAD500FFEDD600E5DCCC00CCD1D100B5B5B600E6E9EA00D9E9
      EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC0089D7EB007CDE
      FF0071D2FD009EE0FE00ADEBFF00A8EAFF00A8EBFF00A4E1F500D0C6C000FFF0
      DE00FFF0E000FFEFDF00FFEFDF00FFEFDF00FFEFDF00FFF2E200FDEBD900D3C7
      BF00D1D4D400E8ECED00DAEAEC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9
      EC00D8E9EC00D8E9EC0090D9EC0087E9FF0078E2FF0072DCFF0077DBFF0078DB
      FF0074E1FE0083BFD900ECD7CF00FFFCEF00FFF3E700FFF4E800FFF4E800FFF4
      E800FFF4E800FFFDF100E9DBD000AB979500D8DEDF00DBEBED00D8E9EC00D8E9
      EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC009DDDED0099F5
      FF007DECFF0084EDFF0081ECFF0081EEFF0082E0EE00CFD0D000FFFFFE00FFFF
      FD00FFFFFA00FFFFFB00FFFFFA00FFFFFB00FFFFFD00FFFFFC00C9C0BE00B5B2
      B500E4F0F200D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9
      EC00D8E9EC00D8E9EC009BD4E700CFFAFD00AEFEFF00A4FCFF00A6FDFF00A4FF
      FF00BAE0E200A2B2BD00BBC3C800E2DDDD00E7E3E200E4D9D800E8DEDE00E1DF
      E000E5DBDB00E3D9D900D7D3D300E7F0F100D9E9EC00D8E9EC00D8E9EC00D8E9
      EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00CCE5EB009ED5
      E8009BDBED009ADDED009ADCED009EDDED008CD0E60090CADE00DAE8EA00D8E8
      EB00D9E8EA00D8E5E800D9E6E900DCEAED00F0EDEE00DBE8EB00D9E7EA00DAEA
      ED00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9EC00D8E9
      EC00D8E9EC00D8E9EC00}
  end
  object QCreditCard: TADOQuery
    Connection = DM.ADOConnection
    CursorType = ctStatic
    Parameters = <
      item
        Name = 'CreditCardID'
        Size = -1
        Value = Null
      end
      item
        Name = 'NID'
        Size = -1
        Value = Null
      end>
    SQL.Strings = (
      
        'Declare @allSession int, @used int, @CreditCardID nvarchar(10), ' +
        '@NID nvarchar(10), @ChargeDate char(10)'
      'set @CreditCardID = :CreditCardID'
      'set @NID = :NID'
      'if @NID <> '#39'-1'#39
      
        '    select top 1 @CreditCardID = CardID from TCreditCard where N' +
        'ID = @NID'
      ''
      'if @CreditCardID is null set @CreditCardID = '#39'-1'#39
      'else'
      'begin'
      
        '  select @ChargeDate = Min(ChargeDate) from TCreditCardCharge wh' +
        'ere CreditCardID = @CreditCardID'
      '  if @ChargeDate is null'
      
        '        select @used = SUM(NumberOfAdult+NumberOfChild) from TRe' +
        'ception'
      '        where CreditCardID = @CreditCardID'
      '  else'
      
        '        select @used = SUM(NumberOfAdult+NumberOfChild) from TRe' +
        'ception'
      
        '        where CreditCardID = @CreditCardID and ReceptionDate >= ' +
        '@ChargeDate'
      'end'
      ''
      ''
      'if @used is null'
      #9'set @used = 0'
      ''
      'select @allSession = SUM(NumberOfSession) from TCreditCardCharge'
      'where CreditCardID = @CreditCardID and Active = 1'
      ''
      'if @allSession is null'
      #9'set @allSession = 0'
      ''
      
        'select CardID, Name+'#39' '#39'+lastName Name, NID, FatherName, Address,' +
        ' Tel, CreditGroupID,'
      
        'Pic, IssueDate, IssueTime, UserID, Active, Type, Title, PriceFor' +
        'Reception, NumberOfCustomer,  '
      
        'Comment, @used used, @allSession allSession from TCreditCard inn' +
        'er join TCreditCardType on TCreditCard.type = TcreditCardType.id'
      'where CardID = @CreditCardID'
      '')
    Left = 168
    Top = 8
  end
  object spReception: TADOStoredProc
    Connection = DM.ADOConnection
    ProcedureName = 'SP_InsertReceptionCreditCard;1'
    Parameters = <
      item
        Name = '@RETURN_VALUE'
        DataType = ftInteger
        Direction = pdReturnValue
        Precision = 10
        Value = Null
      end
      item
        Name = '@CustomerName'
        Attributes = [paNullable]
        DataType = ftWideString
        Size = 100
        Value = Null
      end
      item
        Name = '@CustomerType'
        Attributes = [paNullable]
        DataType = ftSmallint
        Precision = 5
        Value = Null
      end
      item
        Name = '@ReceptionDate'
        Attributes = [paNullable]
        DataType = ftString
        Size = 10
        Value = Null
      end
      item
        Name = '@ReceptionType'
        Attributes = [paNullable]
        DataType = ftSmallint
        Precision = 5
        Value = Null
      end
      item
        Name = '@Shift'
        Attributes = [paNullable]
        DataType = ftSmallint
        Precision = 5
        Value = Null
      end
      item
        Name = '@Credit'
        Attributes = [paNullable]
        DataType = ftInteger
        Precision = 10
        Value = Null
      end
      item
        Name = '@Mobile'
        Attributes = [paNullable]
        DataType = ftBoolean
        Value = Null
      end
      item
        Name = '@Pool'
        Attributes = [paNullable]
        DataType = ftBoolean
        Value = Null
      end
      item
        Name = '@Saat'
        Attributes = [paNullable]
        DataType = ftBoolean
        Value = Null
      end
      item
        Name = '@AngoshtarPlak'
        Attributes = [paNullable]
        DataType = ftBoolean
        Value = Null
      end
      item
        Name = '@Sooeech'
        Attributes = [paNullable]
        DataType = ftBoolean
        Value = Null
      end
      item
        Name = '@Asnad'
        Attributes = [paNullable]
        DataType = ftBoolean
        Value = Null
      end
      item
        Name = '@Pakhsh'
        Attributes = [paNullable]
        DataType = ftBoolean
        Value = Null
      end
      item
        Name = '@KeefPool'
        Attributes = [paNullable]
        DataType = ftBoolean
        Value = Null
      end
      item
        Name = '@Samsonet'
        Attributes = [paNullable]
        DataType = ftBoolean
        Value = Null
      end
      item
        Name = '@Other'
        Attributes = [paNullable]
        DataType = ftWideString
        Size = 200
        Value = Null
      end
      item
        Name = '@Price'
        Attributes = [paNullable]
        DataType = ftInteger
        Precision = 10
        Value = Null
      end
      item
        Name = '@UserID'
        Attributes = [paNullable]
        DataType = ftInteger
        Precision = 10
        Value = Null
      end
      item
        Name = '@CardID'
        Attributes = [paNullable]
        DataType = ftLargeint
        Precision = 19
        Value = Null
      end
      item
        Name = '@JumpClosed'
        Attributes = [paNullable]
        DataType = ftSmallint
        Precision = 5
        Value = Null
      end
      item
        Name = '@NumberOfAdult'
        Attributes = [paNullable]
        DataType = ftInteger
        Precision = 10
        Value = Null
      end
      item
        Name = '@NumberOfChild'
        Attributes = [paNullable]
        DataType = ftInteger
        Precision = 10
        Value = Null
      end
      item
        Name = '@CardID2'
        Attributes = [paNullable]
        DataType = ftLargeint
        Precision = 19
        Value = Null
      end
      item
        Name = '@CardID3'
        Attributes = [paNullable]
        DataType = ftLargeint
        Precision = 19
        Value = Null
      end
      item
        Name = '@Discount'
        Attributes = [paNullable]
        DataType = ftInteger
        Precision = 10
        Value = Null
      end
      item
        Name = '@OrderID'
        Attributes = [paNullable]
        DataType = ftInteger
        Precision = 10
        Value = Null
      end
      item
        Name = '@HotelReceptionID'
        Attributes = [paNullable]
        DataType = ftInteger
        Precision = 10
        Value = Null
      end
      item
        Name = '@KinderGarten'
        Attributes = [paNullable]
        DataType = ftBoolean
        Value = Null
      end
      item
        Name = '@CreditCardID'
        Attributes = [paNullable]
        DataType = ftWideString
        Size = 10
        Value = Null
      end
      item
        Name = '@ReceptionID'
        Attributes = [paNullable]
        DataType = ftLargeint
        Direction = pdInputOutput
        Precision = 19
        Value = Null
      end>
    Left = 8
    Top = 8
  end
  object RvProject: TRvProject
    Engine = RvSystem
    ProjectFile = 'Enterver.rav'
    Left = 75
    Top = 5
  end
  object RvSystem: TRvSystem
    TitleSetup = 'Output Options'
    TitleStatus = 'Report Status'
    TitlePreview = 'Report Preview'
    SystemSetups = [ssAllowCopies, ssAllowCollate, ssAllowDuplex, ssAllowDestPreview, ssAllowDestPrinter, ssAllowDestFile, ssAllowPrinterSetup, ssAllowPreviewSetup]
    SystemOptions = [soAllowPrintFromPreview, soPreviewModal]
    DefaultDest = rdPrinter
    SystemFiler.StatusFormat = 'Generating page %p'
    SystemPreview.ZoomFactor = 100.000000000000000000
    SystemPrinter.Orientation = poLandScape
    SystemPrinter.ScaleX = 100.000000000000000000
    SystemPrinter.ScaleY = 100.000000000000000000
    SystemPrinter.StatusFormat = 'Printing page %p'
    SystemPrinter.Title = 'ReportPrinter Report'
    SystemPrinter.UnitsFactor = 1.000000000000000000
    Left = 43
    Top = 5
  end
  object QPrint: TADOQuery
    Connection = DM.ADOConnection
    Parameters = <
      item
        Name = 'ReceptionID'
        Attributes = [paSigned]
        DataType = ftLargeint
        Precision = 19
        Size = 8
        Value = Null
      end>
    SQL.Strings = (
      
        'select Treception.ReceptionID, CustomerName, CustomerType, Recep' +
        'tionDate,'
      'TReception.NumberOfAdult, TReception.NumberOfChild,'
      
        'ReceptionType, Shift, StartTime, EndTime, TReception.Active, Mob' +
        'ile, Pool, Saat,'
      
        'AngoshtarPlak, Sooeech, Asnad, Pakhsh, KeefPool, Samsonet, Other' +
        ', Price,'
      
        'Treception.UserID as ReceptionUser, Enter, TCard.CardID, CardID2' +
        ', CardID3, BarCode, CardType, CreateDate, ExpireDate,'
      
        'TClosed.ClosedID, KeyNumber, PositionClosed, CompanyName, CardTy' +
        'peName, TClosed.Code, kinderGarten, TicketType'
      
        'from TReception inner join TCard on TReception.CardID=TCard.Card' +
        'ID'
      'inner join TCardType on TCard.CardType=TCardType.CardTypeID'
      'inner join TClosed on TReception.ClosedID=TClosed.ClosedID'
      'inner join TBargain on TCard.BargainID=TBargain.BargainID'
      'inner join TCompany on TBargain.CompanyID=TCompany.CompanyID'
      'where TReception.ReceptionID = :ReceptionID')
    Left = 104
    Top = 8
  end
  object QCredit: TADOQuery
    Connection = DM.ADOConnection
    Parameters = <
      item
        Name = 'ReceptionID'
        Size = -1
        Value = Null
      end>
    SQL.Strings = (
      'Select * from TCredit where ReceptionID= :ReceptionID')
    Left = 136
    Top = 8
  end
  object QCheckIssueTicket: TADOQuery
    Connection = DM.ADOConnection
    Parameters = <
      item
        Name = 'ReceptionDate'
        Size = -1
        Value = Null
      end
      item
        Name = 'CreditCardID'
        Size = -1
        Value = Null
      end>
    SQL.Strings = (
      'select * from TReception'
      
        'where ReceptionDate = :ReceptionDate and CreditCardID = :CreditC' +
        'ardID')
    Left = 216
    Top = 16
  end
end
